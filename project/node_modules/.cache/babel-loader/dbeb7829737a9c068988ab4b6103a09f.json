{"ast":null,"code":"var _jsxFileName = \"/Users/yankogeorgiev/GitHub/ReactSoftuni/project/src/components/catalog/MovieDetails.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState, useContext } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport { MovieContext } from '../../contexts/MovieContext';\nimport { useAuthContext } from '../../contexts/AuthContext';\nimport * as movieService from '../../services/movieService';\nimport * as commentService from '../../services/commentService';\nimport { Footer } from '../Footer';\nimport { Header } from '../Header';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const MovieDetails = () => {\n  _s();\n\n  var _currentMovie$comment;\n\n  const navigate = useNavigate();\n  const {\n    addComment,\n    fetchMovieDetails,\n    selectMovie,\n    movieRemove\n  } = useContext(MovieContext);\n  const {\n    movieId\n  } = useParams();\n  const {\n    user\n  } = useAuthContext();\n  useEffect(() => {\n    document.getElementById('catalog').classList.add('active');\n  }, []);\n  const currentMovie = selectMovie(movieId);\n  useEffect(() => {\n    (async () => {\n      const movieDetails = await movieService.getOne(movieId);\n      const movieComments = await commentService.getByMovieId(movieId);\n      fetchMovieDetails(movieId, { ...movieDetails,\n        comments: movieComments.map(x => `${x.user.email}: ${x.text}`)\n      });\n    })();\n  }, []);\n\n  const addCommentHandler = e => {\n    e.preventDefault();\n    const formData = new FormData(e.target);\n    const comment = formData.get('comment');\n    commentService.create(movieId, comment).then(result => {\n      addComment(movieId, comment);\n    });\n    e.target.reset();\n  };\n\n  const movieDeleteHandler = () => {\n    const confirmation = window.confirm('Are you sure you want to delete this game?');\n\n    if (confirmation) {\n      movieService.remove(movieId).then(() => {\n        movieRemove(movieId);\n        navigate('/catalog');\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"details_card\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: currentMovie.img\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: currentMovie.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: currentMovie.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 17\n      }, this), user._id == currentMovie._ownerId ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: e => {\n            e.preventDefault();\n            navigate(`/details/${movieId}/edit`);\n          },\n          className: \"btn\",\n          children: \"Edit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: movieDeleteHandler,\n          className: \"btn\",\n          children: \"Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"comments_box\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Reviews:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: (_currentMovie$comment = currentMovie.comments) === null || _currentMovie$comment === void 0 ? void 0 : _currentMovie$comment.map(x => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"comment\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: x\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 25\n          }, this)\n        }, x, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 13\n      }, this), currentMovie.comments.length == 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No reviews yet.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this), user.email ? /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"comments\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Add new review:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"form\",\n        onSubmit: addCommentHandler,\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"comment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"btn\",\n          type: \"submit\",\n          value: \"Add Review\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 17\n    }, this) : null, /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n\n_s(MovieDetails, \"mxQ8utnTKNm3VFUy1/F7qU3hpW8=\", false, function () {\n  return [useNavigate, useParams, useAuthContext];\n});\n\n_c = MovieDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"MovieDetails\");","map":{"version":3,"names":["useEffect","useState","useContext","useParams","Link","useNavigate","MovieContext","useAuthContext","movieService","commentService","Footer","Header","MovieDetails","navigate","addComment","fetchMovieDetails","selectMovie","movieRemove","movieId","user","document","getElementById","classList","add","currentMovie","movieDetails","getOne","movieComments","getByMovieId","comments","map","x","email","text","addCommentHandler","e","preventDefault","formData","FormData","target","comment","get","create","then","result","reset","movieDeleteHandler","confirmation","window","confirm","remove","img","title","description","_id","_ownerId","length"],"sources":["/Users/yankogeorgiev/GitHub/ReactSoftuni/project/src/components/catalog/MovieDetails.js"],"sourcesContent":["\nimport { useEffect, useState, useContext } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport { MovieContext } from '../../contexts/MovieContext';\nimport { useAuthContext } from '../../contexts/AuthContext';\n\nimport * as movieService from '../../services/movieService';\nimport * as commentService from'../../services/commentService'\nimport { Footer } from '../Footer';\nimport { Header } from '../Header';\n\nexport const MovieDetails = () => {\n    const navigate = useNavigate();\n    const { addComment ,fetchMovieDetails, selectMovie, movieRemove } = useContext(MovieContext);\n    const { movieId } = useParams();\n    const { user } = useAuthContext();\n    useEffect(()=>{document.getElementById('catalog').classList.add('active')},[])\n\n    const currentMovie = selectMovie(movieId);\n\n    useEffect(() => {\n        (async () => {\n            const movieDetails = await movieService.getOne(movieId);\n            const movieComments = await commentService.getByMovieId(movieId)\n            fetchMovieDetails(movieId, { ...movieDetails, comments: movieComments.map(x=> `${x.user.email}: ${x.text}` )});\n        })();\n    }, [])\n\n    const addCommentHandler = (e) => {\n        e.preventDefault();\n        const formData = new FormData(e.target);\n\n        const comment = formData.get('comment');\n\n        commentService.create(movieId, comment)\n            .then(result => {\n                addComment(movieId, comment);\n            });\n        e.target.reset();\n    };\n\n    const movieDeleteHandler = () => {\n        const confirmation = window.confirm('Are you sure you want to delete this game?');\n\n        if (confirmation) {\n            movieService.remove(movieId)\n                .then(() => {\n                    movieRemove(movieId);\n                    navigate('/catalog');\n                })\n        }\n    }\n    return (\n        <>\n        <Header />\n        <section className='details_card'>\n                <img src={currentMovie.img} />\n                <h1>{currentMovie.title}</h1>\n                <p>{currentMovie.description}</p>\n                {user._id==currentMovie._ownerId\n                ?<>\n                    <button onClick={(e)=>{e.preventDefault();navigate((`/details/${movieId}/edit`))}} className=\"btn\">Edit</button>\n                    <button onClick={movieDeleteHandler} className=\"btn\">Delete</button>\n                </>\n                :null\n                }   \n        </section>\n        <section className='comments_box'>\n            <h2>Reviews:</h2>\n            <ul>\n                {currentMovie.comments?.map(x =>\n                    <li key={x} className=\"comment\">\n                        <p>{x}</p>\n                    </li>\n                )}\n            </ul>\n\n            {currentMovie.comments.length==0 &&\n                <p>No reviews yet.</p>\n            }\n        </section>\n        {user.email\n                ?\n                <section className=\"comments\">\n                <label>Add new review:</label>\n                <form className=\"form\" onSubmit={addCommentHandler}>\n                    <textarea name=\"comment\" />\n                    <input className=\"btn\" type=\"submit\" value=\"Add Review\"/>\n                </form>\n                </section>\n                :null\n                }\n        <Footer />\n        </>\n    );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}